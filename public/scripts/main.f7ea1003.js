"use strict";function listFiles(){$.ajax({url:"../files/",success:function(a){if($("#list-files").html(""),a=JSON.parse(a),a.length>0){$("#list-files").show();var b={files:a},c=template(b);$("#list-files").html(c)}}})}function deleteFile(a){$.ajax({url:"../files/"+a,type:"DELETE",success:function(){listFiles()}})}var source=$("#list-template").html();Handlebars.registerHelper("formatDate",function(a){var b="",c=new Date(a);if("undefined"==typeof c)return"Unknown";var d=new Date,e=d-c;return e/=1e3,60>e?b=b+Math.round(e)+" seconds ago":(e/=60,60>e?b=b+Math.round(e)+" minutes ago":(e/=60,24>e?b=b+Math.round(e)+" hours ago":(e/=24,b=b+Math.round(e)+" days ago"))),b});var template=Handlebars.compile(source);$(document).ready(function(){var a=$(".progress"),b=$(".progress-bar"),c=$(".percent"),d=$("#status");a.hide(),d.hide(),$("#add_file").ajaxForm({beforeSend:function(){d.hide(),a.show(),d.empty();var e="0%";b.width(e),c.html(e)},uploadProgress:function(a,d,e,f){var g=f+"%";b.width(g),c.html(g)},success:function(){var a="100%";b.width(a),c.html(a),d.show(),d.html("Successfully uploaded")},complete:function(){var d="0%";b.width(d),c.html(d),a.hide(),listFiles()},error:function(a){d.show(),d.html(a.responseText)}}),$("#upload_file").change(function(){$("#add_file").submit()}),listFiles()});